# 23 | 文本分类：如何区分特定类型的新闻？

## 文本分类系统的基本框架

1. 采集训练样本：给新闻打上标签
2. 预处理自然语言：词包（bag of words）、分词、词干（Stemming）和归一化（Normalization）、停用词（Stopword）、同义词（Synonyms）和扩展次处理。
3. 训练模型：通过训练数据进行模型拟合的过程，以朴素贝叶斯为例，训练过程是获取分类的先验概率、每个属性的先验概率以及给定某个分类时，出现某个属性的条件概率。
4. 实时分类预测：对于朴素贝叶斯方法而言，分类预测的过程就是根据训练阶段所获得的先验概率和条件概率，来预估给定一系列属性的情况下属于某个分类的后验概率。

## 基于自然语言的预处理

计算机如何理解人类语言？可以用词袋模型，找字和单词。这种模型会忽略出现顺序和语法，将文章看作一个大量单词的组合，每个词的出现都是独立的。通常需要以下一些步骤：

### 分词

- 基于字符串匹配：扫描字符串，正向最大匹配、逆向最大匹配、长词优先等算法，基于字典匹配，算法复杂度底，但是处理歧义词效果不佳。
- 基于统计和机器学习：基于人工标注的词性和统计特征，对中文进行建模。常见序列标注模型有隐马尔科夫模型（HMM，Hidden Markov Model）和条件随机场（CRF， Conditional Random Field）。

### 取词干（stemming）和归一化

比如将 `am, is, are, was, were` 转换成 `be`，将 `car, cars, car's, cars'` 转换成 `car` 这样。还要归一化比如英式、美式的拼写等。

### 停用词

一些祝词比如 `a, an, the` 和 `的、个、你` 等。

这样筛除之后，就可以在基本不损失语义的情况下，减少数据文件的大小，提高效率。但是也要注意一些逻辑词，可能词义差别很大。

### 同义词和扩展词

比如 `番茄，西红柿` 这样的进行转换。

## 运用朴素贝叶斯模型分类

求 P(分类|文章内容)，可以通过朴素贝叶斯模型来计算分类。首先将训练数据分词并且计算概率并且存储，需要计算 分类的先验概率、单词的先验概率、分类下面对应单词的条件概率 三个数据，就可以用朴素贝叶斯来计算了。

需要注意可能会有很多乘积计算，结果可能无限趋向于 0 甚至超出计算机的处理精度，所以需要用一些取 log，将小数转换成绝对值大于 1 等负数等运算技巧。
